---
---

<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  {% assign books = site.books | where: 'is_featured', true | sort: 'date' %}

  <channel>
    <title>{{ site.name | xml_escape }} - Featured Highlights</title>
    <link>{{ site.url }}</link>

    <atom:link href="{{ site.url }}/{{ page.path }}" rel="self" type="application/rss+xml" />
    {% for book in books %}
      {% assign highlights = site.highlights | where:"book_uuid", book.uuid | sort: 'highlighted_on' %}
      {% for highlight in highlights %}
        <item>
          <title>
            {{ book.title | xml_escape }}
            {% if highlight.location and highlight.location != 'No title' %}- {{ highlight.location }}{% endif %}
          </title>
          <description>{{ highlight.content | xml_escape }}</description>
          <pubDate>{{ highlight.date | date_to_rfc822 }}</pubDate>
          <link>{{ site.url }}{{ highlight.url }}</link>
          <guid isPermaLink="true">{{ site.url }}{{ highlight.url }}</guid>
        </item>
      {% endfor %}
    {% endfor %}
  </channel>
</rss>